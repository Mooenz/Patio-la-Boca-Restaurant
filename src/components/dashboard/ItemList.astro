---
interface Props {
	menuItems: any[];
	menuSections: any[];
}

const { menuItems, menuSections } = Astro.props;
---

<div id="items-tab" class="tab-content p-3 md:p-6 hidden">
	<div class="flex flex-wrap gap-4 mb-4 items-center">
		<button id="create-item-btn" class="cursor-pointer px-4 py-2 rounded-lg bg-background hover:bg-accent text-text hover:text-white font-medium transition-base border border-text/20"> Crear Plato </button>
		<div class="flex-1 min-w-[200px]">
			<div class="relative">
				<input type="text" id="search-items" placeholder="Buscar platos..." class="w-full px-4 py-2 pl-10 rounded-lg bg-background border border-text/20 text-text focus:outline-none focus:ring-2 focus:ring-accent transition-base" />
				<svg class="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<circle cx="11" cy="11" r="8"></circle>
					<path d="m21 21-4.3-4.3"></path>
				</svg>
			</div>
		</div>
		<select id="filter-items-section" class="px-4 py-2 rounded-lg bg-background border border-text/20 text-text focus:outline-none focus:ring-2 focus:ring-accent transition-base min-w-[180px]">
			<option value="">Todos los menús</option>
			{menuSections.map((section) => <option value={section.id}>{section.title_es}</option>)}
		</select>
		<p id="items-count" class="text-sm text-text-secondary"></p>
	</div>
	{
		menuItems.length === 0 ? (
			<p class="text-text-secondary text-center py-8">No hay platos disponibles</p>
		) : (
			<div id="items-list" class="space-y-4">
				{menuItems.map((item: any) => (
					<div class="item-entry flex flex-wrap gap-6 items-center justify-between p-4 bg-background rounded-lg border border-text/10 transition-base" data-item-id={item.id} data-section-id={item.menu_section_id} data-search-text={`${item.title_es} ${item.title_en} ${item.price} ${item.menu_sections?.title_es || ''} ${item.category || ''}`.toLowerCase()}>
						<div class="flex-1 w-100">
							<div class="flex items-center gap-3 mb-2">
								<h3 class="font-semibold text-text transition-base">{item.title_es}</h3>
								<span class={`px-2 py-1 text-xs rounded ${item.active ? 'bg-green-500/20 text-green-500' : 'bg-red-500/20 text-red-500'}`}>{item.active ? 'Activo' : 'Inactivo'}</span>
							</div>
							<p class="text-sm text-text-secondary">
								{item.title_en} | {item.price} | {item.menu_sections?.title_es || 'Sin sección'}
							</p>
						</div>
						<div class="flex gap-2">
							<button
								data-action="edit"
								data-id={item.id}
								data-type="item"
								data-section-id={item.menu_section_id}
								data-title-es={item.title_es}
								data-title-en={item.title_en}
								data-description-es={item.description_es || ''}
								data-description-en={item.description_en || ''}
								data-price={item.price}
								data-category={item.category || ''}
								data-active={item.active}
								data-display-order={item.display_order}
								class="cursor-pointer px-4 py-2 text-sm rounded-lg bg-button-background hover:bg-accent text-text hover:text-white transition-base"
							>
								Editar
							</button>
							<button data-action="delete" data-id={item.id} data-type="item" data-name={item.title_es} class="cursor-pointer px-4 py-2 text-sm rounded-lg bg-transparent hover:bg-red-500 text-text hover:text-white transition-base">
								Eliminar
							</button>
						</div>
					</div>
				))}
			</div>
		)
	}
</div>
