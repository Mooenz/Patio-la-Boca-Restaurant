---
interface Props {
	menuSections: any[];
	itemsCountBySection: Record<string, number>;
}

const { menuSections, itemsCountBySection } = Astro.props;
---

<div id="menus-tab" class="tab-content p-3 md:p-6">
	<div class="flex flex-wrap gap-4 mb-4 items-center">
		<button id="create-menu-btn" class="cursor-pointer px-4 py-2 rounded-lg bg-background hover:bg-accent text-text hover:text-white font-medium transition-base border border-text/20"> Crear Menú </button>
		<div class="flex-1 min-w-[200px]">
			<div class="relative">
				<input type="text" id="search-menus" placeholder="Buscar menús..." class="w-full px-4 py-2 pl-10 rounded-lg bg-background border border-text/20 text-text focus:outline-none focus:ring-2 focus:ring-accent transition-base" />
				<svg class="absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
					<circle cx="11" cy="11" r="8"></circle>
					<path d="m21 21-4.3-4.3"></path>
				</svg>
			</div>
		</div>
		<p id="menus-count" class="text-sm text-text-secondary"></p>
	</div>
	{
		menuSections.length === 0 ? (
			<p class="text-text-secondary text-center py-8">No hay menús disponibles</p>
		) : (
			<div id="menus-list" class="space-y-4">
				{menuSections.map((section) => (
					<div class="menu-item flex flex-wrap items-center justify-between gap-6 p-4 bg-background rounded-lg border border-text/10 transition-base" data-section-id={section.id} data-search-text={`${section.title_es} ${section.title_en} ${section.slug}`.toLowerCase()}>
						<div class="flex-1 w-100">
							<div class="flex items-center gap-3 mb-2">
								<h3 class="font-semibold text-text transition-base">{section.title_es}</h3>
								<span class={`px-2 py-1 text-xs rounded ${section.active ? 'bg-green-500/20 text-green-500' : 'bg-red-500/20 text-red-500'}`}>{section.active ? 'Activo' : 'Inactivo'}</span>
							</div>
							<p class="text-sm text-text-secondary">
								{section.title_en} | Tiene {itemsCountBySection[section.id] || 0} Platos
							</p>
						</div>

						<div class="flex gap-2">
							<button data-action="edit" data-id={section.id} data-type="menu" data-slug={section.slug} data-title-es={section.title_es} data-title-en={section.title_en} data-image={section.image} data-active={section.active} data-display-order={section.display_order} class="cursor-pointer px-4 py-2 text-sm rounded-lg bg-button-background hover:bg-accent text-text hover:text-white transition-base">
								Editar
							</button>
							<button data-action="delete" data-id={section.id} data-type="menu" data-name={section.title_es} data-items-count={itemsCountBySection[section.id] || 0} class="cursor-pointer px-4 py-2 text-sm rounded-lg bg-transparent hover:bg-red-500 text-text hover:text-white transition-base">
								Eliminar
							</button>
						</div>
					</div>
				))}
			</div>
		)
	}
</div>
