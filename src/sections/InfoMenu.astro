---
import MenuInfoItem from '@/components/MenuInfoItem.astro';
import { getMenuSections, getMenuItems, dbSectionToSection, dbItemToItem } from '@/utilities/menu-db';

// Obtener secciones activas desde Supabase
const menuSections = await getMenuSections(Astro.cookies, false);

// Cargar items para cada sección y convertir a formato MenuSection
const sectionsWithItems = await Promise.all(
	menuSections.map(async (section) => {
		const items = await getMenuItems(Astro.cookies, section.id, false);
		const menuItems = items.map(dbItemToItem);
		return dbSectionToSection(section, menuItems);
	})
);
---

<section class="element h-[calc(100%-72px)]" style="--delay: 400ms">
	{sectionsWithItems.map((section) => (
		<MenuInfoItem classList="option" data={section} id={section.slug || ''} />
	))}
</section>

<script>
	import { scrollItems } from '@/utilities/animations.ts';

	// Inicializar cuando el DOM esté listo
	document.addEventListener('DOMContentLoaded', () => {
		scrollItems('.option');
	});
</script>
